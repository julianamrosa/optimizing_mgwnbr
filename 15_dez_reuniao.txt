checar as.vector() --> o que precisa realmente manter

trocar sum(matriz) por t(j)%*%matriz, onde j é um vetor de 1s

rodar testes reiniciando a sessão do R e anotr os tempos

investigar estrutura do dist(), ver se consigo fazer de forma a não precisar converter em matriz

olhar código da spgwr

testar spgwr com esses dados e ver o tempo *****